#!/bin/bash

export INSTACK_ROOT=${INSTACK_ROOT:-$(pwd)}

export PATH=$PATH:$INSTACK_ROOT/instack-undercloud:$INSTACK_ROOT/instack-undercloud/scripts

export LKG=${LKG:-0}

if [ "$LKG" = "1" ]; then
    # These are set manually, since they're not part of source-repositories
    export DIB_REPOREF_tripleo_image_elements=701bf0e912c4fdd4cf6970cfbd2491856c43ef99
    export DIB_REPOREF_tripleo_heat_templates=2c982451e6e0ff6a9537cc56324ba6d0d4986712
    export DIB_REPOREF_diskimage_builder=c9bcce2030a93f65dda37e270fb84e142fbab1a5
    export DIB_REPOREF_os_cloud_config=7b984349fe3552270691c6b5882559b005fb42a4
    export DIB_REPOREF_tripleo_incubator=b3a9732afc0480fd43fb1fa713e83b35427f2c70

    # To generate these, run:
    # set-source-vars -m /etc/dib-manifests/dib-manifest-git-instack
    # after a successful installation.
    export DIB_REPOREF_glance=56625d9fab2554eabe993bb4b4cb45c6bf555f70
    export DIB_REPOLOCATION_glance=https://git.openstack.org/openstack/glance.git
    export DIB_REPOREF_heat=f1b8cfd54e6f8683e8cd79de15dcac8bd885a85e
    export DIB_REPOLOCATION_heat=https://git.openstack.org/openstack/heat.git
    export DIB_REPOREF_keystone=bbfd58a6c190607f7063d15a3e2836e40806ef57
    export DIB_REPOLOCATION_keystone=https://git.openstack.org/openstack/keystone.git
    export DIB_REPOREF_neutron=2d4b75b420f39f9572034b914c34be80a4c74eb1
    export DIB_REPOLOCATION_neutron=https://git.openstack.org/openstack/neutron.git
    export DIB_REPOREF_nova=37a8ea9894bc77c62163044ffddafb463d2623a4
    export DIB_REPOLOCATION_nova=https://git.openstack.org/openstack/nova.git
    export DIB_REPOREF_novnc=9b731d3a5811cce05001e1d8fbb0d53e2859c86b
    export DIB_REPOLOCATION_novnc=https://github.com/kanaka/noVNC.git
    export DIB_REPOREF_python_ceilometerclient=5c8a85e3861c0e90ef63325956ca809edca5719a
    export DIB_REPOLOCATION_python_ceilometerclient=https://git.openstack.org/openstack/python-ceilometerclient.git
    export DIB_REPOREF_python_cinderclient=da4117f71c36c2e80eb9590d407b87003adf6679
    export DIB_REPOLOCATION_python_cinderclient=https://git.openstack.org/openstack/python-cinderclient.git
    export DIB_REPOREF_python_glanceclient=dbb242b776908ca50ed8557ebfe7cfcd879366c8
    export DIB_REPOLOCATION_python_glanceclient=https://git.openstack.org/openstack/python-glanceclient.git
    export DIB_REPOREF_python_heatclient=47232fa9b011831e54e8b161d1a2da4b1ea7cd2b
    export DIB_REPOLOCATION_python_heatclient=https://git.openstack.org/openstack/python-heatclient.git
    export DIB_REPOREF_python_ironicclient=d7218d83a2d93a3a5610bc329a271891983700ae
    export DIB_REPOLOCATION_python_ironicclient=https://git.openstack.org/openstack/python-ironicclient.git
    export DIB_REPOREF_python_keystoneclient=9fc3a0fd102993f9124978a2d47804f438cb55a1
    export DIB_REPOLOCATION_python_keystoneclient=https://git.openstack.org/openstack/python-keystoneclient.git
    export DIB_REPOREF_python_neutronclient=2b3cf686d6451cfcd9d3fccee2a428751f1cee4a
    export DIB_REPOLOCATION_python_neutronclient=https://git.openstack.org/openstack/python-neutronclient.git
    export DIB_REPOREF_python_novaclient=deef71af93f67901d191b569b972581219f5723c
    export DIB_REPOLOCATION_python_novaclient=https://git.openstack.org/openstack/python-novaclient.git
    export DIB_REPOREF_python_swiftclient=d5a45fcd2d92c1328d35c54e09712c1152f1af19
    export DIB_REPOLOCATION_python_swiftclient=https://git.openstack.org/openstack/python-swiftclient.git

fi

export ELEMENTS_PATH="\
$INSTACK_ROOT/instack-undercloud/elements:\
$INSTACK_ROOT/tripleo-image-elements/elements/:\
$INSTACK_ROOT/diskimage-builder/elements/"

export OVERCLOUD_CONTROL_DIB_EXTRA_ARGS="\
baremetal \
base \
boot-stack \
ceilometer-agent-central \
ceilometer-agent-notification \
ceilometer-api \
ceilometer-collector \
cinder-api \
cinder-tgt \
cinder-volume \
common-venv \
dhcp-all-interfaces \
haproxy \
horizon \
hosts \
keepalived \
mariadb-rdo \
neutron-network-node \
ntp \
os-collect-config \
pip-cache \
rabbitmq-server \
stable-interface-names \
stackuser \
swift-proxy \
swift-storage \
use-ephemeral \
"

export OVERCLOUD_COMPUTE_DIB_EXTRA_ARGS="\
baremetal \
dhcp-all-interfaces \
fedora-rdo-icehouse-repository \
neutron-openvswitch-agent \
nova-compute \
nova-kvm \
os-collect-config \
os-refresh-config-reboot \
pip-cache \
stable-interface-names \
stackuser
"

export OVERCLOUD_CINDER_DIB_EXTRA_ARGS="\
baremetal \
cinder-volume \
common-venv \
dhcp-all-interfaces \
neutron-openvswitch-agent \
os-collect-config \
os-refresh-config-reboot \
pip-cache \
stable-interface-names \
stackuser \
"

export OVERCLOUD_SWIFT_DIB_EXTRA_ARGS="\
baremetal \
common-venv \
dhcp-all-interfaces \
neutron-openvswitch-agent \
os-collect-config \
os-refresh-config-reboot \
pip-cache \
stable-interface-names \
stackuser \
swift-storage \
"
