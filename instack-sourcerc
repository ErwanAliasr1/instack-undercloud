#!/bin/bash

export INSTACK_ROOT=${INSTACK_ROOT:-$(pwd)}

export PATH=$PATH:$INSTACK_ROOT/instack-undercloud:$INSTACK_ROOT/instack-undercloud/scripts

export LKG=${LKG:-0}

if [ "$LKG" = "1" ]; then
    # These are set manually, since they're not part of source-repositories
    export DIB_REPOREF_tripleo_image_elements=c304a061124d98456d80edf4fe887bec257e373f
    export DIB_REPOREF_tripleo_heat_templates=2c982451e6e0ff6a9537cc56324ba6d0d4986712
    export DIB_REPOREF_diskimage_builder=6f7af6f5a202f8b4008f6f5b0c7a4e737bb9ff65
    export DIB_REPOREF_os_cloud_config=7b984349fe3552270691c6b5882559b005fb42a4
    export DIB_REPOREF_tripleo_incubator=b6caa77a930005c9df5b188ea1513320df387713

    # To generate these, run:
    # set-source-vars -m /etc/dib-manifests/dib-manifest-git-instack
    # after a successful installation.
    export DIB_REPOREF_glance=36818b4a6ef2b319a137e56578f86ca2ed8b774c
    export DIB_REPOLOCATION_glance=https://git.openstack.org/openstack/glance.git
    export DIB_REPOREF_heat=ce65e9bdb23d81b9379cdbbea88af10c89e63536
    export DIB_REPOLOCATION_heat=https://git.openstack.org/openstack/heat.git
    export DIB_REPOREF_keystone=fdc643bd2f0bfe094f4945f1cbe26f211b957b10
    export DIB_REPOLOCATION_keystone=https://git.openstack.org/openstack/keystone.git
    export DIB_REPOREF_neutron=a1736689e1789ec32ac1d4873dff5d33c86ff9b8
    export DIB_REPOLOCATION_neutron=https://git.openstack.org/openstack/neutron.git
    export DIB_REPOREF_nova=288c650dbc4d404e44ca0d188484da14ba008dc1
    export DIB_REPOLOCATION_nova=https://git.openstack.org/openstack/nova.git
    export DIB_REPOREF_novnc=9b731d3a5811cce05001e1d8fbb0d53e2859c86b
    export DIB_REPOLOCATION_novnc=https://github.com/kanaka/noVNC.git
    export DIB_REPOREF_python_ceilometerclient=5c8a85e3861c0e90ef63325956ca809edca5719a
    export DIB_REPOLOCATION_python_ceilometerclient=https://git.openstack.org/openstack/python-ceilometerclient.git
    export DIB_REPOREF_python_cinderclient=0c4010e7fbc9939905e8647afbe1358c384dc658
    export DIB_REPOLOCATION_python_cinderclient=https://git.openstack.org/openstack/python-cinderclient.git
    export DIB_REPOREF_python_glanceclient=f75a81000e1060d608c624ff8e3287e8c99a5123
    export DIB_REPOLOCATION_python_glanceclient=https://git.openstack.org/openstack/python-glanceclient.git
    export DIB_REPOREF_python_heatclient=47232fa9b011831e54e8b161d1a2da4b1ea7cd2b
    export DIB_REPOLOCATION_python_heatclient=https://git.openstack.org/openstack/python-heatclient.git
    export DIB_REPOREF_python_ironicclient=28340b7af8bfaa250e5a282b1a5d03b080deaa21
    export DIB_REPOLOCATION_python_ironicclient=https://git.openstack.org/openstack/python-ironicclient.git
    export DIB_REPOREF_python_keystoneclient=5daafe1d3b74e8d540925e991d8f60f263034e28
    export DIB_REPOLOCATION_python_keystoneclient=https://git.openstack.org/openstack/python-keystoneclient.git
    export DIB_REPOREF_python_neutronclient=2b3cf686d6451cfcd9d3fccee2a428751f1cee4a
    export DIB_REPOLOCATION_python_neutronclient=https://git.openstack.org/openstack/python-neutronclient.git
    export DIB_REPOREF_python_novaclient=e551cb0a34351db6b76c2f119205c28bcd802b62
    export DIB_REPOLOCATION_python_novaclient=https://git.openstack.org/openstack/python-novaclient.git
    export DIB_REPOREF_python_swiftclient=d5a45fcd2d92c1328d35c54e09712c1152f1af19
    export DIB_REPOLOCATION_python_swiftclient=https://git.openstack.org/openstack/python-swiftclient.git


fi

export ELEMENTS_PATH="\
$INSTACK_ROOT/instack-undercloud/elements:\
$INSTACK_ROOT/tripleo-image-elements/elements/:\
$INSTACK_ROOT/diskimage-builder/elements/"

export OVERCLOUD_CONTROL_DIB_EXTRA_ARGS="\
baremetal \
base \
boot-stack \
ceilometer-agent-central \
ceilometer-agent-notification \
ceilometer-api \
ceilometer-collector \
cinder-api \
cinder-tgt \
cinder-volume \
common-venv \
dhcp-all-interfaces \
haproxy \
horizon \
hosts \
keepalived \
mariadb-rpm \
neutron-network-node \
ntp \
os-collect-config \
pip-cache \
rabbitmq-server \
stable-interface-names \
stackuser \
swift-proxy \
swift-storage \
use-ephemeral \
"

export OVERCLOUD_COMPUTE_DIB_EXTRA_ARGS="\
baremetal \
base \
common-venv \
dhcp-all-interfaces \
hosts \
neutron-openvswitch-agent \
nova-compute \
nova-kvm \
ntp \
os-collect-config \
pip-cache \
pypi-openstack \
stable-interface-names \
stackuser \
use-ephemeral
"

export OVERCLOUD_CINDER_DIB_EXTRA_ARGS="\
baremetal \
base \
cinder-volume \
common-venv \
dhcp-all-interfaces \
hosts \
neutron-openvswitch-agent \
ntp \
os-collect-config \
pip-cache \
pypi-openstack \
stable-interface-names \
stackuser \
use-ephemeral \
"

export OVERCLOUD_SWIFT_DIB_EXTRA_ARGS="\
baremetal \
base \
common-venv \
dhcp-all-interfaces \
hosts \
neutron-openvswitch-agent \
ntp \
os-collect-config \
pip-cache \
pypi-openstack \
stable-interface-names \
stackuser \
swift-storage \
use-ephemeral \
"
